export default class VulnerabilityService {
    getVulnerabilities(api, projectId, params){
        let url = "/projects/" + projectId + "/vulnerabilities/"
        let config = {}
        if (params){
            config["params"] = params
        }
        return api.get(url, config)
    }

    deleteVulnerability(api, projectId, vulnerabilityId){
        let url = "/projects/" + projectId + "/vulnerabilities/" + vulnerabilityId + "/"
        return api.delete(url)
    }

    createVulnerability(api, projectId, data){
        let url = "/projects/" + projectId + "/vulnerabilities/"
        return api.post(url, data)
    }

    getCategories(api){
        let url = "/vulnerability-categories/"
        return api.get(url)
    }

    getCWEs(api, params){
        let url = "/cwes/"
        let config = {}
        if (params){
            config["params"] = params
        }
        return api.get(url, config)
    }

    getCWE(api, cweId){
        let url = "/cwes/" + cweId + "/"
        return api.get(url)
    }

    patchVulnerability(api, projectId, vulnerabilityId, data){
        let url = "/projects/" + projectId + "/vulnerabilities/" + vulnerabilityId + "/"
        return api.patch(url, data)
    }

    getVulnerability(api, projectId, vulnId){
        let url = "/projects/" + projectId + "/vulnerabilities/" + vulnId + "/"
        return api.get(url)
    }
}